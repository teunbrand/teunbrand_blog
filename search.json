[
  {
    "objectID": "posts/2024-12-14-legendry-0-2-0/index.html",
    "href": "posts/2024-12-14-legendry-0-2-0/index.html",
    "title": "On bubbles and trees",
    "section": "",
    "text": "I now have the awkward pride of announcing a fresh update to an already new package, barely a month after its release. On the one hand I did a little bit of future-proofing, hopefully preventing it from being kicked out of CRAN in the next half year. On the other hand, I also developed a few features that Iâ€™m excited to share!"
  },
  {
    "objectID": "posts/2024-12-14-legendry-0-2-0/index.html#bubbles",
    "href": "posts/2024-12-14-legendry-0-2-0/index.html#bubbles",
    "title": "On bubbles and trees",
    "section": "Bubbles",
    "text": "Bubbles\nThe first thing Iâ€™d like to parade around is a new standalone guide for the size aesthetic. The guide_circles() function lets you build a guide that displays the size of points as a series of rings. Simultaneously is source of frustration, but also a neat thing is that this guide uses actual points drawn by the layer glyph function. Taking the correct measurements of points and aligning them was a bit fussy to develop, but at least for circular points, it should work as youâ€™d expect!\n\n\nCode\nlibrary(legendry)\n#&gt; Loading required package: ggplot2\n\ngapminder::gapminder |&gt;\n  dplyr::filter(year == max(year)) |&gt;\n  ggplot(aes(gdpPercap, lifeExp, size = pop, fill = continent)) +\n  geom_point(shape = 21) +\n  scale_size_area(\n    # Note that we need irregular breaks because we scale area, not radius\n    limits = c(0, NA), max_size = 20,\n    breaks = c(0, 100, 500, 1000)*1e6,\n    labels = c(0, \"100M\", \"500M\", \"1B\"),\n    guide  = guide_circles(vjust = 1)\n  ) +\n  scale_x_log10() +\n  labs(\n    x = \"GDP per capita\",\n    y = \"Life expectancy\",\n    fill = \"Continent\",\n    size = \"Population\"\n  )\n\n\n\n\n\n\n\n\n\nI hasten to mention that Iâ€™m not the first to develop such a guide, but I think that this is the first version that is implemented as a ggplot2 guide. See scatterpie or mapsf for other implementations."
  },
  {
    "objectID": "posts/2024-12-14-legendry-0-2-0/index.html#trees",
    "href": "posts/2024-12-14-legendry-0-2-0/index.html#trees",
    "title": "On bubbles and trees",
    "section": "Trees",
    "text": "Trees\nThe next addition in this release is a guide for dendrograms. There are plenty of better packages to plot dendrograms for the sake of dendrograms, like dendextend. Instead, legendry now has a new scale/guide pair whose job it is to display dendrograms as axis annotations. Iâ€™ve personally enjoyed these annotations in combination with heatmaps.\nThe new scales scale_x_dendro() and scale_y_dendro() accept a &lt;hclust&gt; object generated from the eponymous function. The scale itself just ensure that discrete categories are sorted by the dendrogram order.\nIt is the guide that comes with these scales, guide_axis_dendro() that does the heavy lifting of actually displaying the dendrogram.\n\n\nCode\ncar_cor &lt;- cor(t(mtcars), method = \"spearman\")\ncar_clusters &lt;- hclust(as.dist(1 - car_cor))\n\ndata &lt;- reshape2::melt(car_cor)\n\np &lt;- ggplot(data, aes(Var1, Var2, fill = value)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  scale_x_dendro(car_clusters, guide = guide_axis_dendro(labels = FALSE)) +\n  scale_y_dendro(car_clusters) +\n  labs(x = \"Cars\", y = \"Cars\", fill = expression(rho^2)) +\n  guides(x.sec = guide_axis(angle = 90))\n\np + coord_fixed()\n\n\n\n\n\n\n\n\n\nYou may correctly point out that a similar thing already exists in the ggh4x package. The primary difference is that guide_axis_dendro() uses legendryâ€™s gimmicks, such as composed guides. This implies both that it is build on the newer guide system introduced in ggplot2 3.5.0 and that it works well with coord_radial().\n\n\nCode\nggplot(mtcars, aes(rownames(mtcars), mpg)) +\n  geom_col(width = 1) +\n  coord_radial(inner.radius = 0.5, expand = FALSE) +\n  labs(x = NULL, y = NULL) +\n  scale_x_dendro(car_clusters) +\n  guides(\n    theta = guide_axis_base(angle = 90),\n    theta.sec = guide_axis_dendro(labels = FALSE),\n    r = \"none\"\n  ) +\n  theme(plot.margin = margin(t = 50, b = 50))\n\n\n\n\n\n\n\n\n\nIn one of the very rare cases that a secondary theta axis can be useful, the dendrogram guide can be placed in the center of polar plots. These shennanigans make it easy to create visualisation like radiating phylogenetic trees.\nWith all of that wrapped up, all that is left is wishing you all happy holidays!\n\n\nSession info\nsi &lt;- sessioninfo::session_info()\n# Deidentifying paths on my personal machine\nsi$packages$library &lt;- NULL\nsi$platform$pandoc &lt;- NULL\nprint(si)\n#&gt; â”€ Session info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n#&gt;  setting  value\n#&gt;  version  R version 4.4.2 (2024-10-31 ucrt)\n#&gt;  os       Windows 11 x64 (build 22631)\n#&gt;  system   x86_64, mingw32\n#&gt;  ui       RTerm\n#&gt;  language (EN)\n#&gt;  collate  English_Netherlands.utf8\n#&gt;  ctype    English_Netherlands.utf8\n#&gt;  tz       Europe/Amsterdam\n#&gt;  date     2024-12-14\n#&gt; \n#&gt; â”€ Packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n#&gt;  package     * version  date (UTC) lib source\n#&gt;  cli           3.6.3    2024-06-21 []  CRAN (R 4.4.1)\n#&gt;  colorspace    2.1-1    2024-07-26 []  CRAN (R 4.4.1)\n#&gt;  digest        0.6.37   2024-08-19 []  CRAN (R 4.4.1)\n#&gt;  dplyr         1.1.4    2023-11-17 []  CRAN (R 4.4.0)\n#&gt;  evaluate      1.0.1    2024-10-10 []  CRAN (R 4.4.1)\n#&gt;  fansi         1.0.6    2023-12-08 []  CRAN (R 4.4.0)\n#&gt;  farver        2.1.2    2024-05-13 []  CRAN (R 4.4.0)\n#&gt;  fastmap       1.2.0    2024-05-15 []  CRAN (R 4.4.0)\n#&gt;  gapminder     1.0.0    2023-03-10 []  CRAN (R 4.4.1)\n#&gt;  generics      0.1.3    2022-07-05 []  CRAN (R 4.4.0)\n#&gt;  ggplot2     * 3.5.1    2024-04-23 []  CRAN (R 4.4.2)\n#&gt;  glue          1.8.0    2024-09-30 []  CRAN (R 4.4.1)\n#&gt;  gtable        0.3.6    2024-10-25 []  CRAN (R 4.4.1)\n#&gt;  htmltools     0.5.8.1  2024-04-04 []  CRAN (R 4.4.0)\n#&gt;  htmlwidgets   1.6.4    2023-12-06 []  CRAN (R 4.4.0)\n#&gt;  jsonlite      1.8.9    2024-09-20 []  CRAN (R 4.4.1)\n#&gt;  knitr         1.49     2024-11-08 []  CRAN (R 4.4.2)\n#&gt;  labeling      0.4.3    2023-08-29 []  CRAN (R 4.4.0)\n#&gt;  legendry    * 0.2.0    2024-12-14 []  local\n#&gt;  lifecycle     1.0.4    2023-11-07 []  CRAN (R 4.4.0)\n#&gt;  magrittr      2.0.3    2022-03-30 []  CRAN (R 4.4.0)\n#&gt;  munsell       0.5.1    2024-04-01 []  CRAN (R 4.4.0)\n#&gt;  pillar        1.9.0    2023-03-22 []  CRAN (R 4.4.0)\n#&gt;  pkgconfig     2.0.3    2019-09-22 []  CRAN (R 4.4.0)\n#&gt;  plyr          1.8.9    2023-10-02 []  CRAN (R 4.4.0)\n#&gt;  R6            2.5.1    2021-08-19 []  CRAN (R 4.4.0)\n#&gt;  ragg          1.3.3    2024-09-11 []  CRAN (R 4.4.1)\n#&gt;  Rcpp          1.0.13-1 2024-11-02 []  CRAN (R 4.4.2)\n#&gt;  reshape2      1.4.4    2020-04-09 []  CRAN (R 4.4.0)\n#&gt;  rlang         1.1.4    2024-06-04 []  CRAN (R 4.4.0)\n#&gt;  rmarkdown     2.29     2024-11-04 []  CRAN (R 4.4.2)\n#&gt;  rstudioapi    0.17.1   2024-10-22 []  CRAN (R 4.4.1)\n#&gt;  scales        1.3.0    2023-11-28 []  CRAN (R 4.4.2)\n#&gt;  sessioninfo   1.2.2    2021-12-06 []  CRAN (R 4.4.0)\n#&gt;  stringi       1.8.4    2024-05-06 []  CRAN (R 4.4.0)\n#&gt;  stringr       1.5.1    2023-11-14 []  CRAN (R 4.4.0)\n#&gt;  systemfonts   1.1.0    2024-05-15 []  CRAN (R 4.4.0)\n#&gt;  textshaping   0.4.1    2024-12-06 []  CRAN (R 4.4.2)\n#&gt;  tibble        3.2.1    2023-03-20 []  CRAN (R 4.4.0)\n#&gt;  tidyselect    1.2.1    2024-03-11 []  CRAN (R 4.4.0)\n#&gt;  utf8          1.2.4    2023-10-22 []  CRAN (R 4.4.0)\n#&gt;  vctrs         0.6.5    2023-12-01 []  CRAN (R 4.4.0)\n#&gt;  viridisLite   0.4.2    2023-05-02 []  CRAN (R 4.4.0)\n#&gt;  withr         3.0.2    2024-10-28 []  CRAN (R 4.4.1)\n#&gt;  xfun          0.49     2024-10-31 []  CRAN (R 4.4.1)\n#&gt;  yaml          2.3.10   2024-07-26 []  CRAN (R 4.4.1)\n#&gt; \n#&gt; \n#&gt; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
  },
  {
    "objectID": "posts/2024-10-28-hello-world/index.html",
    "href": "posts/2024-10-28-hello-world/index.html",
    "title": "Hello world",
    "section": "",
    "text": "Iâ€™ve never been a big blogger, so setting up my own blog is a bit of an unfamiliar process. As you are reading these words, I must have had achieved this goal despite inexperience.\nAt the time of writing, you might have stumbled upon this bloggy looking page through my activity coding in the R language. I suppose that in the future, this blog will serve some less fleeting, medium-form communication need from me to the rest of the world. I now think it will be mostly about R programming, data visualisation and ggplot2. But I certainly donâ€™t know what the future holds. These communications will neither be perfect nor complete, but that shouldnâ€™t stymy me from stirring up these word salads, nor stymy you from lurking about on the internet.\nAside from a few guest posts in another place, this is my first solo post and as such, I suppose some introduction is in order. Hello, my name is Teun1 van den Brand, I live in Amsterdam, The Netherlands and have been coding in R since 2017. Previously, Iâ€™ve worked as a PhD student/researcher doing computational work in the analysis of chromatin biology in the lab of Elzo de Wit. Essentially Iâ€™ve looked at a lot of DNA sequencing data from assays on chromatin folding and organisation, which I analysed mostly in R.\nDuring this time, Iâ€™ve whipped up my fair share of scientific data visualisations in regular reporting, presentations and publications. I liked this part a lot. You can clearly see how differently an audience responds to a thought-out figure versus a data-dump of a figure. It engages the audience more, regardless of the obscurity of your field, which will yield more sharp-witted questions and relevant feedback for you. Naturally, this had put me into the orbit of ggplot2 as the most widely recognised visualisation paradigm in the R programming language. What started as a personal cookbook for wrangling ggplot2 figures in the exact shape I needed, turned into a collection of hacks mud-wrestling about under ggplot2â€™s hood, which eventually grew out to the extension package ggh4x. It perfectly fits the clichÃ© that somebodyâ€™s first package is a â€˜miscellaneousâ€™ package.\nSomehow Thomas, who maintains ggplot2, must have noticed that my rummaging was sufficiently useful to offer me the opportunity to do this full time. So that is the way Iâ€™ve stumbled from ggplot2â€™s orbit to landing a paid gig to do what I already loved doing."
  },
  {
    "objectID": "posts/2024-10-28-hello-world/index.html#footnotes",
    "href": "posts/2024-10-28-hello-world/index.html#footnotes",
    "title": "Hello world",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nTeun (/tÃ¸Ën/) is a very Dutch name and pronounced similar to how one would say â€˜tewnâ€™ or â€˜tuwnâ€™ in English. You can hear somebody say it hereâ†©ï¸"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Teun van den Brand is a consultant based in Amsterdam, the Netherlands. He currently works on open source tools for data visualisation, specifically ggplot2 in the R language for Posit, PBC."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Overview",
    "section": "",
    "text": "On bubbles and trees\n\n\n\n\n\n\npackage\n\n\nupdate\n\n\n\nAnnouncing two more guides joining the family.\n\n\n\n\n\nDec 14, 2024\n\n\nTeun van den Brand\n\n\n\n\n\n\n\n\n\n\n\n\nGuidance for legendry\n\n\n\n\n\n\npackage\n\n\nannouncement\n\n\n\nWherein I announce a new package to expand your arsenal of guides\n\n\n\n\n\nNov 1, 2024\n\n\nTeun van den Brand\n\n\n\n\n\n\n\n\n\n\n\n\nHello world\n\n\n\n\n\n\nnews\n\n\n\nWherein I introduce myself\n\n\n\n\n\nOct 28, 2024\n\n\nTeun van den Brand\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2024-11-01-legendry-0-1-0/index.html",
    "href": "posts/2024-11-01-legendry-0-1-0/index.html",
    "title": "Guidance for legendry",
    "section": "",
    "text": "Iâ€™m glad to announce that the legendry package has landed on CRAN! It is a ggplot2 extension package, focussed on expanding the guide options. If youâ€™re looking to try out legendry yourself, you can install it with:\ninstall.packages(\"legendry\")\nI like plot annotations. Guides are among the most important plot annotations, as they instruct an observer on how a graphic should be interpreted. They are essential in getting the data to divulge their story.\nIâ€™ve always found it hard to place annotations outside the panels of a plot and usually resorted to post-editing the figures in vector graphics software such as Adobe Illustrator to nicely place these. However, as people might be aware, it can take several iterations to get from the first serious figure to the final figure you use in your communication. This makes editing the figures every time very cumbersome. In addition, it is not reproducible, so we should aim to incorporate some flexibility in annotating our figures. This package is my attempt at that."
  },
  {
    "objectID": "posts/2024-11-01-legendry-0-1-0/index.html#growing-this-package",
    "href": "posts/2024-11-01-legendry-0-1-0/index.html#growing-this-package",
    "title": "Guidance for legendry",
    "section": "Growing this package",
    "text": "Growing this package\nThe seed that sprouted this package germinated in April 2020. Hey, it was at a time when we all were looking into alternate hobbies when the lockdowns started! In any case, the idea started as guide_axis_nested() in ggh4x, which was ultimately reincarnated as: â€¦ guide_axis_nested().\nHowever, I took some convincing to take the guide related functionality in ggh4x and make an offshoot package. (Like any self-respecting amateur developer, I had no idea what the scope of ggh4x should be). The first graft of this offshoot was called â€˜gguidanceâ€™, traditionally using the â€˜ggâ€™-prefix before ggplot2 extension packages, and it was about guides ğŸ¤·ï¸.Nobody, including myself knew how to pronounce this name, so that is how â€˜legendryâ€™ was born.\nAt the time, the issue was that the guide system, as one of the last vestiges in ggplot2, was still written in the S3 object oriented programming style. This lacked the great extensibility of other ggplot2 systems, like stats, geoms or facets that all uses the rather specialised â€”but highly flexibleâ€” ggproto system. As such, the guide system was explicitly advertised as not an extension point.\nIt took a bit of path clearing to build legendry. To cut a long story significantly shorter: I volunteered for the rewrite, got offered a job maintaining ggplot2, and midwifed the 3.5.0 release of ggplot2 which formally makes guides an extension point."
  },
  {
    "objectID": "posts/2024-11-01-legendry-0-1-0/index.html#concepts-in-legendry",
    "href": "posts/2024-11-01-legendry-0-1-0/index.html#concepts-in-legendry",
    "title": "Guidance for legendry",
    "section": "Concepts in legendry",
    "text": "Concepts in legendry\nThe package has website including vignettes to talk you through most of its functionality. As such, Iâ€™ll try to convey the big picture ideas here and leave the details up for you to peruse at your leisure.\n\nScale interaction\nPerhaps the most gentle introduction is legendry is that you now have the power to intervene in what scales pass on to guides. Most guides in legendry accept a key argument, that you can customise to some degree. You can read more in the vignette, but here are three examples using axes.\n\nlibrary(legendry)\n#&gt; Loading required package: ggplot2\n\nggplot(msleep, aes(sleep_total, bodywt)) +\n  geom_point(na.rm = TRUE) +\n  scale_y_log10() +\n  guides(\n    # A regular key, but add minor ticks\n    x = guide_axis_base(key = \"minor\", title = \"Total sleep (hours)\"),\n    # A log key\n    y = guide_axis_base(key = \"log\", title = \"Body weight (kg)\"),\n    # A manual key\n    x.sec = guide_axis_base(\n      key = key_manual(\n        c(200, 400, 600, 800, 1000, 1200) / 60,\n        label = c(200, 400, 600, 800, 1000, 1200),\n        colour = rep(c(\"tomato\", \"dodgerblue\"), length.out = 6)\n      ),\n      title = \"minutes\"\n    )\n  )\n\n\n\n\n\n\n\n\n\n\nComplete guides\nThe package has a few â€˜completeâ€™ guides that are drop-in replacements for ggplot2â€™s guides. Sometimes, these attempt to literally mirror ggplot2â€™s guides, give or take a few tweaks, like guide_axis_base() or guide_legend_base(). Other times, these convey novel relations between items, like guide_axis_nested() useful for indicating ranges, or guide_legend_groups() for indicating groups.\n\nfood &lt;- data.frame(\n  category = c(\"Meat\", \"Meat\", \"Vegetables\", \"Vegetables\", \"Dairy\"),\n  food     = c(\"Beef\", \"Chicken\", \"Carrots\", \"Onions\", \"Cheese\"),\n  gram     = c(85,  85, 150, 210, 225),\n  calories = c(245, 185, 45, 80, 240)\n)\n\nggplot(food, aes(interaction(food, category), calories)) +\n  geom_col(aes(fill = paste(category, food))) +\n  guides(\n    # Using a nested axis to visualise ranges innate to the data\n    x = \"axis_nested\", \n    # Split up legend into groups\n    fill = \"legend_group\",\n    # Custimising nested axis to display ranges\n    y = guide_axis_nested(\n      key_range_manual(0, 100, \"low calories\"),\n      # Local theme to rotate y-axis text for only this guide\n      theme = theme(axis.text.y.left = element_text(angle = 90, hjust = 0.5))\n    )\n  ) +\n  # Global theme\n  theme_classic()\n\n\n\n\n\n\n\n\nSee the accompanying vignette for more details. You might wonder: â€œthe existence of the term â€˜complete guidesâ€™ implies the existence of â€˜incomplete guidesâ€™â€. Youâ€™d be right. In legendry, these are called â€˜primitivesâ€™, like primitive_bracket(), for aesthetic-agnostic building blocks and â€˜gizmosâ€™, as in gizmo_histogram(), for speciality displays.\n\n\nComposed guides\nThe last idea is that we should be able to assemble complicated guides from simpler parts. There are ways to make regular guides, like guide_axis_base(), or even simpler guides, like primitive_bracket() and combine these to build rich annotations. The way guides are combined is using compose_*() functions. For example compose_ontop() will overlay two guides, whereas compose_stack() will draw the second guide after the first guide. Moreover, you can have compositions inside compositions, so there is some room for creativity here. It is somewhat of a tougher task to get right, so Iâ€™ve tried to elaborate some more in the vignette. At any rate, here is an example of how guide composition can work.\n\nair_dates &lt;- data.frame(\n  year = as.Date(c(\"1974-01-01\", \"1985-01-01\", \"1994-01-01\", \"2008-01-01\")),\n  title = c(\"Little House\\non the Prairie\", \"The Golden\\nGirls\", \n            \"Friends\", \"Breaking\\nBad\")\n)\n\n# Let's say we want to display when the shows started with arrows\ntv_show_guide &lt;- guide_axis_base(\n  key = key_map(air_dates, aesthetic = year, label = title),\n  # Local theme for long arrows as ticks\n  theme = theme(\n    axis.ticks.length = unit(14, \"pt\"),\n    axis.ticks = element_line(arrow = arrow(length = unit(2, \"mm\")))\n  )\n)\n\n# We'd like to place these arrows ontop of a regular guide\nontop &lt;- compose_ontop(\"axis_base\", tv_show_guide)\n\n# In addition, we might want to annotate the ruling president at the time\npresident_guide &lt;- primitive_bracket(\n  key = key_range_map(presidential, start = start, end = end, name = name),\n  bracket = \"square\"\n)\n\nggplot(economics, aes(date, unemploy)) +\n  geom_line() +\n  guides(x = compose_stack(ontop, president_guide))"
  },
  {
    "objectID": "posts/2024-11-01-legendry-0-1-0/index.html#future",
    "href": "posts/2024-11-01-legendry-0-1-0/index.html#future",
    "title": "Guidance for legendry",
    "section": "Future",
    "text": "Future\nThe package is now in a usable state, which is reflected in its release to CRAN. My hope is that together with people in the ggplot2 community, we can expand the set of guides even further! Should you find any bugs or have good ideas, the issue tracker on GitHub is the place where I track these.\nIâ€™m looking forward to seeing some legendary plots out in the wilds!"
  }
]